"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.pwaPlugin = void 0;
const utils_1 = require("@vuepress/utils");
const generateServiceWorker_1 = require("./generateServiceWorker");
const pwaPlugin = ({ serviceWorkerFilename = 'service-worker.js', ...generateSWConfig } = {}) => (app) => {
    const plugin = {
        name: '@vuepress/plugin-pwa',
    };
    if (app.env.isDev) {
        return plugin;
    }
    return {
        ...plugin,
        clientConfigFile: utils_1.path.resolve(__dirname, '../client/config.js'),
        define: {
            __PWA_SW_FILENAME__: serviceWorkerFilename,
        },
        onGenerated: (app) => (0, utils_1.withSpinner)('Generating service worker')(() => (0, generateServiceWorker_1.generateServiceWorker)(app, serviceWorkerFilename, generateSWConfig)),
    };
};
exports.pwaPlugin = pwaPlugin;
